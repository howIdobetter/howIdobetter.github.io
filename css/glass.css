/*
  Glassmorphism + modern motion layer for Hexo Fluid.
  - Palette based on #3498db (primary)
  - Light/Dark via html[data-user-color-scheme]
  - Uses transform/opacity for GPU-friendly animations
*/

:root {
  /* --- Color palette (Light) --- */
  --gh-primary: #3498db;
  --gh-secondary-1: #6c5ce7;
  --gh-secondary-2: #2ecc71;
  --gh-accent: #f39c12;

  --gh-text: rgba(20, 28, 38, 0.88);
  --gh-text-muted: rgba(20, 28, 38, 0.65);
  --gh-line: rgba(20, 28, 38, 0.10);

  /* Multi-layer background */
  --gh-bg-0: radial-gradient(1200px 700px at 12% 12%, rgba(52, 152, 219, 0.18), transparent 52%),
             radial-gradient(900px 600px at 88% 22%, rgba(108, 92, 231, 0.14), transparent 55%),
             radial-gradient(800px 520px at 50% 88%, rgba(46, 204, 113, 0.10), transparent 55%),
             linear-gradient(180deg, rgba(255, 255, 255, 0.92), rgba(255, 255, 255, 0.98));

  /* Glass parameters */
  --gh-glass-bg: rgba(255, 255, 255, 0.08);
  --gh-glass-bg-strong: rgba(255, 255, 255, 0.14);
  --gh-glass-border: rgba(255, 255, 255, 0.10);
  --gh-glass-blur: 10px;
  --gh-glass-sat: 180%;

  /* Rhythm (ratio ~1.25) */
  --gh-space-1: 0.8rem;
  --gh-space-2: 1rem;
  --gh-space-3: 1.25rem;
  --gh-space-4: 1.563rem;
  --gh-space-5: 1.953rem;
  --gh-space-6: 2.441rem;

  --gh-radius: 16px;
  --gh-radius-sm: 12px;

  /* Shadow (subtle; keep theme-friendly) */
  --gh-shadow: 0 18px 48px rgba(0, 0, 0, 0.12);
  --gh-shadow-hover: 0 22px 60px rgba(0, 0, 0, 0.18);

  /* Motion */
  --gh-ease: cubic-bezier(0.2, 0.7, 0.2, 1);
  --gh-duration: 420ms;
}

html[data-user-color-scheme='dark'] {
  /* --- Color palette (Dark) --- */
  --gh-primary: #55b7f3;
  --gh-secondary-1: #8a7dff;
  --gh-secondary-2: #48e39a;
  --gh-accent: #ffbf4a;

  --gh-text: rgba(240, 245, 255, 0.88);
  --gh-text-muted: rgba(240, 245, 255, 0.62);
  --gh-line: rgba(240, 245, 255, 0.12);

  --gh-bg-0: radial-gradient(1200px 700px at 12% 12%, rgba(85, 183, 243, 0.16), transparent 52%),
             radial-gradient(900px 600px at 88% 22%, rgba(138, 125, 255, 0.14), transparent 55%),
             radial-gradient(800px 520px at 50% 88%, rgba(72, 227, 154, 0.10), transparent 55%),
             linear-gradient(180deg, rgba(8, 10, 14, 0.96), rgba(8, 10, 14, 0.98));

  --gh-glass-bg: rgba(0, 0, 0, 0.20);
  --gh-glass-bg-strong: rgba(0, 0, 0, 0.30);
  --gh-glass-border: rgba(255, 255, 255, 0.08);

  --gh-shadow: 0 18px 48px rgba(0, 0, 0, 0.42);
  --gh-shadow-hover: 0 22px 60px rgba(0, 0, 0, 0.52);
}

/* --- Typography --- */
html, body {
  color: var(--gh-text);
  background: var(--gh-bg-0);
  background-attachment: fixed;
}

body {
  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC",
    "Hiragino Sans GB", "Microsoft YaHei", "Noto Sans SC", Arial, sans-serif;
}

code, pre, kbd, samp {
  font-family: ui-monospace, "JetBrains Mono", "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}

/* --- Utility: glass surface --- */
.gh-glass {
  background-color: var(--gh-glass-bg);
  border: 1px solid var(--gh-glass-border);
  border-radius: var(--gh-radius);
  box-shadow: var(--gh-shadow);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .gh-glass {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .gh-glass {
    /* fallback: slightly stronger translucency */
    background-color: var(--gh-glass-bg-strong);
  }
}

/* --- Apply glass to theme components (no HTML changes required) --- */

/* Navbar */
#navbar.navbar {
  background-color: var(--gh-glass-bg) !important;
  border-bottom: 1px solid var(--gh-glass-border);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  #navbar.navbar {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

/* Cards (index list) */
.index-card {
  border-radius: var(--gh-radius);
  border: 1px solid var(--gh-glass-border);
  background-color: var(--gh-glass-bg);
  box-shadow: var(--gh-shadow);
  overflow: hidden;
  transition: transform var(--gh-duration) var(--gh-ease), box-shadow var(--gh-duration) var(--gh-ease), background-color var(--gh-duration) var(--gh-ease);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .index-card {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

.index-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--gh-shadow-hover);
  background-color: var(--gh-glass-bg-strong);
}

/* --- Homepage: immersive content grid (CSS Grid) --- */
html.gh-home #board .col-12.col-md-10.m-auto {
  display: grid;
  grid-template-columns: minmax(0, 1fr);
  gap: var(--gh-space-5);
}

html.gh-home #board .col-12.col-md-10.m-auto > nav,
html.gh-home #board .col-12.col-md-10.m-auto > .pagination,
html.gh-home #board .col-12.col-md-10.m-auto > .paginator {
  grid-column: 1 / -1;
}

/* Neutralize Bootstrap row negative margins inside grid items */
html.gh-home .index-card.row {
  margin-left: 0;
  margin-right: 0;
}

@media (min-width: 992px) {
  html.gh-home #board .col-12.col-md-10.m-auto {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
}

@media (min-width: 1440px) {
  html.gh-home #board .col-12.col-md-10.m-auto {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}

/* Sidebar widgets (post pages) */
.sidebar .card,
.sidebar .widget,
.sidebar .widget-wrap,
#toc {
  border-radius: var(--gh-radius);
  border: 1px solid var(--gh-glass-border);
  background-color: var(--gh-glass-bg);
  box-shadow: var(--gh-shadow);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .sidebar .card,
  .sidebar .widget,
  .sidebar .widget-wrap,
  #toc {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

/* Footer */
.footer-inner {
  border-top: 1px solid var(--gh-glass-border);
  background-color: var(--gh-glass-bg);
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .footer-inner {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

/* Dialog (search modal) */
.modal-content {
  border-radius: var(--gh-radius);
  border: 1px solid var(--gh-glass-border);
  background-color: var(--gh-glass-bg-strong) !important;
}

@supports ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .modal-content {
    -webkit-backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
    backdrop-filter: blur(var(--gh-glass-blur)) saturate(var(--gh-glass-sat));
  }
}

/* --- Links: underline reveal animation --- */
main a:not(.nav-link):not(.btn):not(.badge) {
  position: relative;
  color: var(--gh-primary);
  text-decoration: none;
  transition: color 220ms var(--gh-ease);
}

main a:not(.nav-link):not(.btn):not(.badge)::after {
  content: "";
  position: absolute;
  left: 50%;
  bottom: -0.12em;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, var(--gh-secondary-1), var(--gh-primary), var(--gh-accent));
  transform: translateX(-50%) scaleX(0);
  transform-origin: center;
  transition: transform 260ms var(--gh-ease);
  opacity: 0.9;
}

main a:not(.nav-link):not(.btn):not(.badge):hover {
  color: var(--gh-accent);
}

main a:not(.nav-link):not(.btn):not(.badge):hover::after {
  transform: translateX(-50%) scaleX(1);
}

/* --- Read progress bar (JS drives width) --- */
#reading-progress {
  position: fixed;
  left: 0;
  top: 0;
  height: 3px;
  width: 0;
  background: linear-gradient(90deg, var(--gh-secondary-1), var(--gh-primary), var(--gh-accent));
  z-index: 9999;
  transform: translateZ(0);
}

/* --- Entrance animations (stagger via --gh-delay) --- */
.gh-anim {
  opacity: 0;
  transform: translate3d(0, 10px, 0);
  filter: blur(2px);
  will-change: transform, opacity;
}

html.gh-loaded .gh-anim {
  animation: gh-enter var(--gh-duration) var(--gh-ease) var(--gh-delay, 0ms) both;
}

@keyframes gh-enter {
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
    filter: blur(0);
  }
}

/* --- Scroll reveal (IntersectionObserver adds .gh-inview) --- */
.gh-reveal {
  opacity: 0;
  transform: translate3d(-12px, 0, 0);
}

.gh-reveal.gh-inview {
  opacity: 1;
  transform: translate3d(0, 0, 0);
  transition: transform var(--gh-duration) var(--gh-ease), opacity var(--gh-duration) var(--gh-ease);
}

/* Images blur -> clear */
.gh-img {
  filter: blur(5px);
  transform: translate3d(0, 6px, 0);
  transition: filter 520ms var(--gh-ease), transform 520ms var(--gh-ease);
}

.gh-img.gh-inview {
  filter: blur(0);
  transform: translate3d(0, 0, 0);
}

/* --- Button ripple target (JS inserts .gh-ripple) --- */
.gh-ripple-host {
  position: relative;
  overflow: hidden;
}

.gh-ripple {
  position: absolute;
  border-radius: 50%;
  transform: translate(-50%, -50%) scale(0);
  background: rgba(255, 255, 255, 0.35);
  animation: gh-ripple 520ms var(--gh-ease);
  pointer-events: none;
}

html[data-user-color-scheme='dark'] .gh-ripple {
  background: rgba(255, 255, 255, 0.22);
}

@keyframes gh-ripple {
  to {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0;
  }
}

/* --- Banner parallax (JS sets --gh-parallax) --- */
#banner.banner {
  background-position: center calc(50% + var(--gh-parallax, 0px)) !important;
}

/* --- Responsive + mobile glass perf degrade --- */
@media (max-width: 768px) {
  :root {
    --gh-glass-blur: 8px;
  }
  .index-card {
    border-radius: var(--gh-radius-sm);
  }
}

@media (max-width: 400px) {
  :root {
    --gh-glass-blur: 6px;
  }
}

/* --- Motion accessibility --- */
@media (prefers-reduced-motion: reduce) {
  html.gh-loaded .gh-anim {
    animation: none !important;
    opacity: 1;
    transform: none;
    filter: none;
  }
  .index-card,
  .gh-reveal,
  .gh-img,
  main a:not(.nav-link):not(.btn):not(.badge)::after {
    transition: none !important;
  }
}
